<div class="container">
    <div class="row" *ngIf="audits$ | async as audits">
        <table class="table" mat-table [dataSource]="audits" style="width: 100%;" border="0">
            <ng-container matColumnDef="createdAt">
                <th mat-header-cell *matHeaderCellDef> CREATED AT </th>
                <td mat-cell *matCellDef="let element"> {{element.createdAt}} </td>
            </ng-container>
        
            <ng-container matColumnDef="updatedAt">
                <th mat-header-cell *matHeaderCellDef> UPDATED AT  </th>
                <td mat-cell *matCellDef="let element"> {{element.updatedAt}} </td>
            </ng-container>
        
            <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef> EMAIL </th>
                <td mat-cell *matCellDef="let element"> {{element.email ? element.email : 'Email Not Entered'}} </td>
            </ng-container>
        
            <ng-container matColumnDef="serverIp">
                <th mat-header-cell *matHeaderCellDef> SERVER IP </th>
                <td mat-cell *matCellDef="let element"> {{element.serverIp}} </td>
            </ng-container>
        
            <ng-container matColumnDef="clientIp">
                <th mat-header-cell *matHeaderCellDef> CLIENT IP </th>
                <td mat-cell *matCellDef="let element"> {{element.clientIp}} </td>
            </ng-container>
        
            <ng-container matColumnDef="statusCode">
                <th mat-header-cell *matHeaderCellDef> STATUS CODE </th>
                <td mat-cell *matCellDef="let element"> {{element.statusCode}} </td>
            </ng-container>
        
            <ng-container matColumnDef="statusMessage">
                <th mat-header-cell *matHeaderCellDef> STATUS MESSAGE </th>
                <td mat-cell *matCellDef="let element"> 
                    <span *ngIf="element.statusMessage === 'OK'" style="font-weight: bolder;color:green;">LOGIN SUCCESS</span>
                    <span *ngIf="element.statusMessage !== 'OK'" style="font-weight: bolder;color:red;">LOGIN FAIL</span>
                </td>
            </ng-container>
        
            <ng-container matColumnDef="uri">
                <th mat-header-cell *matHeaderCellDef> URI </th>
                <td mat-cell *matCellDef="let element"> {{element.uri}} </td>
            </ng-container>
        
            <ng-container *ngFor="let field of ['clientIpDetails','serverIpDetails']">
                <ng-container matColumnDef="{{field.includes('client')? 'client_org' :  'server_org'}}">
                    <th mat-header-cell *matHeaderCellDef> {{field.includes('client')? 'CLIENT ' :  'SERVER '}}ORG </th>
                    <td mat-cell *matCellDef="let element"> {{element[field][0].org}} </td>
                </ng-container>
            </ng-container>
          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator [length]="totalItems$ | async"
                      [pageSize]="pageSize"
                      [pageSizeOptions]="[5, 10, 25, 100]"
                      (page)="pageNavigate($event)"
                      aria-label="Select page">
        </mat-paginator>
    </div>
</div>